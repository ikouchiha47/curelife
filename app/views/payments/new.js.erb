  <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" id="rzp-button1">Pay</button>

  <script src="https://checkout.razorpay.com/v1/checkout.js" data-buttontext="Pay with RazorPay">
    var options = {
      key: "<%= razorpay_api_key %>",
      amount: "<%= @appointment.amount_to_pay %>"
      currency: "INR",
      name: "Curelife",
      description: "Medical Services",
      handler: function(response) {
        var data = new FormData();
        let fields = ["razorpay_order_id", "razorpay_payment_id", "razorpay_signature"]
        fields.forEach(function(field) {
            data.append(field, response[field])
        })

        console.log(fields)
        fetch("<%= url_for(controller: 'payments', action: 'create') %>", {method: 'POST', body: data}).then(resp => resp.text()).then(x => console.log(x))
      },
      order_id:"<%= @booking.razorpay_order_id %>",
      prefill: {
        name: "<%= current_user.full_name %>",
        email: "<%= current_user.email || "dummy@gmail.com" %>",
      },
      theme: {
        color: "#fff",
        backdrop_color: "#3399cc"
      }

    }

    let rzp = new RazorPay(options)
    rzp.on('payment,failed', function(resp) {
        var data = new FormData();
        data.append('error_code', resp.error.code)
        data.append('error_source', resp.error.source)
        data.append('reason', resp.error.reason)
        data.append('error_order_id', resp.error.metadata.order_id)
        data.append('error_payment_id', resp.error.metadata.payment_id)

        fetch("<%= url_for(controller: 'payments', action: 'delete') %>", {method: 'POST', body: data}).then(resp => resp.text()).then(x => console.log(x))
    })

    $("#rzp-button1").addEventListener("click", function(e) {
      e.preventDefault()
      rzp.open()
    })

  </script>
